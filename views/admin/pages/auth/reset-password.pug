extends ../../layouts/auth.pug
include ../../mixins/alert.pug

block main
  +alert-error(5000)
  +alert-success(5000)

  .container.my-5
    .row.justify-content-center
      .col-8
        h1(class="text-center") Đặt lại mật khẩu
        form(
          action=`/${prefixAdmin}/auth/reset-password`
          method="POST"
          id="resetPasswordForm"
        )
          div(class="form-group")
            label(for="password") Mật khẩu mới
            input(
              type="password"
              class="form-control"
              id="password"
              name="password"
              required
              minlength="6"
            )
          div(class="form-group")
            label(for="confirmPassword") Xác nhận mật khẩu
            input(
              type="password"
              class="form-control"
              id="confirmPassword"
              name="confirmPassword"
              required
              minlength="6"
            )
            small(id="passwordError" class="text-danger" style="display: none;") Mật khẩu xác nhận không khớp
          div(class="form-group")
            button(
              type="submit"
              class="btn btn-primary btn-block"
              id="submitBtn"
            ) Đặt lại mật khẩu
          div(class="form-group text-center")
            a(href=`/${prefixAdmin}/auth/login`) Quay lại đăng nhập

block script
  script.
    document.getElementById('resetPasswordForm').addEventListener('submit', function(e) {
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      const passwordError = document.getElementById('passwordError');
      const submitBtn = document.getElementById('submitBtn');
      
      if (password !== confirmPassword) {
        e.preventDefault();
        passwordError.style.display = 'block';
        submitBtn.disabled = true;
        setTimeout(() => {
          passwordError.style.display = 'none';
          submitBtn.disabled = false;
        }, 3000);
      } else {
        passwordError.style.display = 'none';
      }
    });
    
    document.getElementById('confirmPassword').addEventListener('input', function() {
      const password = document.getElementById('password').value;
      const confirmPassword = this.value;
      const passwordError = document.getElementById('passwordError');
      
      if (confirmPassword && password !== confirmPassword) {
        passwordError.style.display = 'block';
      } else {
        passwordError.style.display = 'none';
      }
    });
